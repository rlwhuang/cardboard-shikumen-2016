!function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e){if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";AFRAME.aframeCore.registerComponent("drag-look-controls",{dependencies:["position","rotation"],schema:{enabled:{"default":!0}},init:function(){var t=this.el.sceneEl;this.setupMouseControls(),this.setupHMDControls(),this.attachEventListeners(),t.addBehavior(this),this.previousPosition=new THREE.Vector3,this.deltaPosition=new THREE.Vector3},setupMouseControls:function(){this.canvasEl=document.querySelector("a-scene").canvas,this.mouseDown=!1,this.pitchObject=new THREE.Object3D,this.yawObject=new THREE.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},setupHMDControls:function(){this.dolly=new THREE.Object3D,this.euler=new THREE.Euler,this.controls=new THREE.VRControls(this.dolly),this.zeroQuaternion=new THREE.Quaternion},attachEventListeners:function(){var t=document.querySelector("a-scene").canvas;t.addEventListener("mousedown",this.onMouseDown.bind(this),!0),t.addEventListener("mousemove",this.onMouseMove.bind(this),!0),t.addEventListener("mouseup",this.releaseMouse.bind(this),!0),t.addEventListener("mouseout",this.releaseMouse.bind(this),!0),t.addEventListener("touchstart",this.onTouchStart.bind(this)),t.addEventListener("touchmove",this.onTouchMove.bind(this)),t.addEventListener("touchend",this.onTouchEnd.bind(this))},update:function(){this.data.enabled&&(this.controls.update(),this.updateOrientation(),this.updatePosition())},updateOrientation:function(){var t=new THREE.Euler;return t.order="YXZ",function(){var e=this.pitchObject,o=this.yawObject,n=this.calculateHMDQuaternion();t.setFromQuaternion(n),this.el.setAttribute("rotation",{x:THREE.Math.radToDeg(t.x)+THREE.Math.radToDeg(e.rotation.x),y:THREE.Math.radToDeg(t.y)+THREE.Math.radToDeg(o.rotation.y),z:THREE.Math.radToDeg(t.z)})}}(),calculateHMDQuaternion:function(){var t=new THREE.Quaternion;return function(){var e=this.dolly;return this.zeroed||e.quaternion.equals(this.zeroQuaternion)||(this.zeroOrientation(),this.zeroed=!0),t.copy(this.zeroQuaternion).multiply(e.quaternion),t}}(),updatePosition:function(){var t=new THREE.Vector3,e=new THREE.Quaternion,o=new THREE.Vector3;return function(){var n=this.el,i=this.calculateDeltaPosition(),s=n.getComputedAttribute("position");this.el.object3D.matrixWorld.decompose(t,e,o),i.applyQuaternion(e),n.setAttribute("position",{x:s.x+i.x,y:s.y+i.y,z:s.z+i.z})}}(),calculateDeltaPosition:function(){var t=this.dolly,e=this.deltaPosition,o=this.previousPosition;return e.copy(t.position),e.sub(o),o.copy(t.position),e},updateHMDQuaternion:function(){var t=new THREE.Quaternion;return function(){var e=this.dolly;return this.controls.update(),this.zeroed||e.quaternion.equals(this.zeroQuaternion)||(this.zeroOrientation(),this.zeroed=!0),t.copy(this.zeroQuaternion).multiply(e.quaternion),t}}(),zeroOrientation:function(){var t=new THREE.Euler;t.setFromQuaternion(this.dolly.quaternion.clone().inverse()),t.z=0,t.x=0,this.zeroQuaternion.setFromEuler(t)},onMouseMove:function(t){var e=Math.PI/2,o=this.pitchObject,n=this.yawObject,i=this.previousMouseEvent;if(this.mouseDown&&this.data.enabled){var s=t.movementX||t.mozMovementX,r=t.movementY||t.mozMovementY;void 0!==s&&void 0!==r||(s=t.screenX-i.screenX,r=t.screenY-i.screenY),this.previousMouseEvent=t,n.rotation.y+=.002*s,o.rotation.x+=.002*r,o.rotation.x=Math.max(-e,Math.min(e,o.rotation.x))}},onMouseDown:function(t){this.mouseDown=!0,this.previousMouseEvent=t,this.updateCursor()},releaseMouse:function(){this.mouseDown=!1,this.updateCursor()},onTouchStart:function(t){1===t.touches.length&&(this.touchStart={x:t.touches[0].pageX,y:t.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(t){var e,o=this.yawObject;this.touchStarted&&(e=2*Math.PI*(t.touches[0].pageX-this.touchStart.x)/this.canvasEl.clientWidth,o.rotation.y+=.5*e,this.touchStart={x:t.touches[0].pageX,y:t.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},updateCursor:function(){var t=this.el.sceneEl,e=t.canvas;e&&(e.style.cursor=this.mouseDown?"all-scroll":"default")}})}]);